{% liquid
  assign grid_gap = section.settings.grid_gap
  assign bg_color = section.settings.bg_color
%}

{% capture grid_style %}
  --grid-columns:1; --grid-columns-md:2; --grid-columns-lg:3; --grid-gap:{{ grid_gap }}rem;
{% endcapture %}

{% capture bg_style %}
  {% if bg_color != blank %}
    background: {{ bg_color }}
  {% endif %}
{% endcapture %}

<div data-gap="-sm" data-columns="-sm,-md,-lg" class="ra-grid" style="{{ grid_style }} {{ bg_style }}">
  {% for block in section.blocks %}
    {% if block.settings.two_grid_items %}
      {% capture grid_item_style %}
        --grid-column:1; --grid-column-md:2; --grid-column-lg:1;
      {% endcapture %}
      <div data-column="-sm,-md,-lg" class="ra-grid-item" style="{{ grid_item_style }}">
        <div
          data-gap="-sm"
          data-columns="-sm,-md,-lg"
          class="ra-grid ra-grid--inherit-gap"
          style="--grid-columns:2; --grid-columns-md:2; --grid-columns-lg:1;"
        >
          <div class="ra-grid-item">
            {%
              render 'ra-content-tile',
              classes: 'ra-content-tile set--details-overlay set--aspect-ratio-fill-space',
              image: block.settings.image,
              subtitle: block.settings.eyebrow_text,
              title: block.settings.title,
              header_level: 'h2',
              description: block.settings.description,
              horizontal_align: 'center',
              vertical_align: 'middle',
            %}
          </div>
          {% if block.settings.image_2 != blank %}
            <div class="ra-grid-item">
              {%
                render 'ra-content-tile',
                classes: 'ra-content-tile set--details-overlay set--aspect-ratio-fill-space',
                image: block.settings.image_2,
                subtitle: block.settings.eyebrow_text_2,
                title: block.settings.title_2,
                header_level: 'h2',
                description: block.settings.description_2,
                horizontal_align: 'center',
                vertical_align: 'middle',
              %}
            </div>
          {% endif %}
        </div>
      </div>
    {% else %}
      {% capture grid_item_style %}
        --grid-column: 2; --grid-column-md: 2; --grid-column-lg: 2;
      {% endcapture %}
      <div class="ra-grid-item" style="{{ grid_item_style }}">
        {%
          render 'ra-content-tile',
          classes: 'ra-content-tile set--details-overlay set--aspect-ratio-fill-space',
          image: block.settings.image,
          subtitle: block.settings.eyebrow_text,
          title: block.settings.title,
          header_level: 'h2',
          description: block.settings.description,
          horizontal_align: 'center',
          vertical_align: 'middle',
        %}
      </div>
    {% endif %}
  {% endfor %}
</div>

{% schema %}
{
  "name": "Content Tile Grid",
  "settings": [
    {
      "type": "range",
      "id": "grid_gap",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "rem",
      "label": "Grid Gap (in rem)",
      "default": 1
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background Color",
      "info": "Set Background color that is visible between the gaps"
    }
  ],
  "blocks": [
    {
      "type": "grid-column",
      "name": "Grid Column",
      "limit": 3,
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "eyebrow_text",
          "label": "Grid Item Eyebrow Text"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title"
        },
        {
          "type": "richtext",
          "id": "description",
          "label": "Description"
        },
        {
          "type": "checkbox",
          "id": "two_grid_items",
          "label": "Enable Two Column Split",
          "info": "Enable ability to add two tiles in this column",
          "default": false
        },
        {
          "type": "header",
          "content": "Second Grid Column Item (if applicable)"
        },
        {
          "type": "image_picker",
          "id": "image_2",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "eyebrow_text_2",
          "label": "Eyebrow Text"
        },
        {
          "type": "text",
          "id": "title_2",
          "label": "Title 2"
        },
        {
          "type": "richtext",
          "id": "description_2",
          "label": "Description 2"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Content Tile Grid"
    }
  ]
}
{% endschema %}
