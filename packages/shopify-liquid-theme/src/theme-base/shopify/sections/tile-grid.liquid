{% liquid
  assign gridGap = section.settings.grid_gap
%}

{% capture gridStyles %}
  {{ gridGap }}; --grid-columns:1; --grid-columns-md:2; --grid-columns-lg:3
{% endcapture %}

<div class="ra-grid" style="{{ gridStyle }}">
  {% for block in section.blocks %}
    {% if block.settings.two_grid_items %}
      {% capture gridItemStyle %}
        --grid-column:1; --grid-column-md:2; --grid-column-lg:1;
      {% endcapture %}
      <div class="ra-grid-item" style="{{ gridItemStyle }}">
        <div class="ra-grid ra-grid--inherit-gap" style="--grid-columns:2; --grid-columns-md:2; --grid-columns-lg:1;">

          <div class="ra-grid-item">
            <article class="ra-content-tile set--details-overlay set--aspect-ratio-fill-space">
              <div class="ra-content-tile__media component-media"></div>
              <div class="ra-content-tile__details component-details"></div>
            </article>
          </div>
          <div class="ra-grid-item">
            <article class="ra-content-tile set--details-overlay set--aspect-ratio-fill-space">
              <div class="ra-content-tile__media component-media"></div>
              <div class="ra-content-tile__details component-details"></div>
            </article>
          </div>
        </div>
      </div>
    {% else %}
      <div class="ra-grid-item" style="{{ gridItemStyle }}">
        <article class="ra-content-tile set--details-overlay set--aspect-ratio-fill-space">
          {% if block.settings.image %}
            <div class="ra-content-tile__media component-media">
              <div data-testid="image-wrapper" class="ra-image ra-content-tile__image ra-image--use-aspect-ratio">
                <img loading="lazy" src="{{ block.settings.image | img_url: '500x' }}" alt="{{ block.settings.image.alt }}" class="ra-image__media">
              </div>
            </div>
          {% endif %}
          <div class="ra-content-tile__details component-details">
            <div class="ra-content-tile__copy set--v-align-middle set--h-align-center">
              {% if block.settings.subtitle != blank %}
                <div class="ra-content-tile__subtitle">
                  {{- block.settings.subtitle -}}
                </div>
              {% endif %}
              {% if block.settings.title != blank %}
                <h2 class="ra-title ra-content-tile__title" style="--title-font-size:var(--font-size-h6);">
                  <div>{{- block.settings.title -}}</div>
                </h2>
              {% endif %}
              {% if block.settings.description != blank %}
                <div class="ra-content-tile__description">
                  {{- block.settings.description -}}
                </div>
              {% endif %}
            </div>
          </div>
        </article>
      </div>
    {% endif %}
  {% endfor %}
</div>

{%- schema -%}
  {
    "name": "Split Section",
    "settings": [
      {
        "type": "number",
        "id": "columns",
        "label": "Set number of Columns",
        "default": 3
      }
    ],
    "blocks": [
      {
        "type": "grid-column",
        "name": "Grid Column",
        "limit": 3,
        "settings": [
          {
            "type": "checkbox",
            "id": "two_grid_items",
            "label": "Enable two column split",
            "default": false
          },
          {
            "type": "image_picker",
            "id": "image",
            "label": "Image"
          },
          {
            "type": "text",
            "id": "subtitle",
            "label": "Grid Item Sub-title"
          },
          {
            "type": "text",
            "id": "title",
            "label": "Grid Item Title"
          },
          {
            "type": "richtext",
            "id": "description",
            "label": "Grid Item Description"
          },
          {
            "type": "header",
            "content": "Second Grid Column Item (if applicable)"
          }
        ]
      }
    ]
  }
{%- endschema -%}