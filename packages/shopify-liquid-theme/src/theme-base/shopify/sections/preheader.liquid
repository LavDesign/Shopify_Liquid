{% style %}
  #shopify-section-{{ section.id }} {
    --preheader-background-color: var({{ section.settings.bg_color }});
    --preheader-text-color: var({{ section.settings.text_color }});
  }
{% endstyle %}

{% capture arrow_color %}
  var({{section.settings.text_color}})
{% endcapture %}

{% capture swiper_settings %}
  {
    "loop": true,
    {% if section.settings.autoplay %}
      "autoplay": {
        "delay": {{ section.settings.delay | times: 1000 }}
      },
    {% endif %}
    "slidesPerView": 1,
    "spaceBetween": 0,
    "navigation": {
      "nextEl": ".{{ section.id }}.swiper-button-next",
      "prevEl": ".{{ section.id }}.swiper-button-prev"
    }
  }
{% endcapture %}

{% if section.blocks.size > 0 %}
  <div class="ra-preheader__wrapper">
    
    <div class="ra-preheader__slider ra-preheader__slider--{{ section.settings.alignment }}">
      <div class="swiper" data-swiper-settings="{{ swiper_settings | escape | strip }}">
        <div class="swiper-wrapper">
          {% for block in section.blocks %}
            <div class="swiper-slide">
              {% if block.settings.text != blank %}
                <div class="ra-preheader__text">{{ block.settings.text }}</div>
              {% endif %}
            </div>
          {% endfor %}
        </div>

        {% if section.blocks.size > 1 %}
          <div class="{{ section.id }} swiper-button-prev">
            {% render 'icon', icon: "chevron-left", width: '14px', height: '14px', color: arrow_color %}
          </div>
          <div class="{{ section.id }} swiper-button-next">
            {% render 'icon', icon: "chevron-right", width: '14px', height: '14px', color: arrow_color %}
          </div>
        {% endif %}
      </div>
    </div>
    {% render 'ra-header-util' %}
  </div>
{% endif %}

{% schema %}
{
  "name": "Pre-header",
  "class": "ra-preheader",
  "max_blocks": 5,
  "settings": [
    {
      "type": "select",
      "id": "bg_color",
      "label": "Background color",
      "options": <%- uikit.colorsAll -%>,
      "default": "--color-secondary-500"
    },
    {
      "type": "select",
      "id": "text_color",
      "label": "Text color",
      "options": <%- uikit.colorsAll -%>,
      "default": "--color-util-red"
    },
    {
      "type": "header",
      "content": "Slider"
    },
    {
      "type": "select",
      "id": "alignment",
      "label": "Slider alignment",
      "info": "Select hero height",
      "options": [
        {
          "value": "center",
          "label": "Center align"
        },
        {
          "value": "left",
          "label": "Left align"
        }
      ],
      "default": "center"
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Autoplay",
      "default": false
    },
    {
      "type": "range",
      "id": "delay",
      "min": 3,
      "max": 10,
      "step": 1,
      "unit": "s",
      "label": "Delay",
      "default": 5,
      "info": "Delay between transitions (in seconds). Applys delay only if 'Autoplay' is checked."
    }
  ],
  "blocks": [
    {
      "type": "message",
      "name": "Message",
      "settings": [
        {
          "type": "richtext",
          "id": "text",
          "default": "<p>Welcome to our store.</p>",
          "label": "Text"
        }
      ]
    }
  ],
  "default": {
    "blocks": [
      {
        "type": "message"
      },
      {
        "type": "message"
      },
      {
        "type": "message"
      }
    ]
  }
}
{% endschema %}
