{% comment %}
  Make a list of filters to display as buttons based on filter.label
{% endcomment %}

{% liquid
  assign button_filters_string = 'size'
  assign button_filters = button_filters_string | split: ','
%}

<ra-search-filters>
  <div class="flex justify-between mb-2">
    <div class="h5 text-grey-700">Filters</div>
    <button class="ra-link ra-link--sm" data-clear-filters>Clear All</button>
  </div>
  <div
    id="SearchActiveFilters"
    class="ra-filters__active-filters flex flex-wrap gap-2 py-3 border-t border-grey-400"
    data-active-filters
  >
    {% for filter in search.filters %}
      {% for filter_value in filter.active_values %}
        <div class="inline-flex gap-[6px] items-center py-2 px-2 bg-grey-100 font-light">
          <span>{{ filter_value.label }}</span>
          <button
            class="flex items-center"
            data-action-remove-filter
            data-param="{{ filter.param_name }}"
            data-value="{{ filter_value.value | replace: " ", "+" }}"
          >
            {% render 'ra-icon' with 'close', width: '12px', height: '12px' %}
          </button>
        </div>
      {% endfor %}
    {% endfor %}
  </div>
  <form id="SearchFilters" data-search-filters>
    <ra-accordion class="ra-accordion" data-multi-open="true">
      {%- for filter in search.filters -%}
        {% assign display_as_buttons = false %}
        {% assign filter_label = filter.label | downcase | strip %}

        {% if button_filters contains filter_label %}
          {% assign display_as_buttons = true %}
        {% endif %}

        {% capture filter_content %}
          {% render "ra-filter-group", filter: filter, display_as_buttons: display_as_buttons %}
        {% endcapture %}

        {% render 'ra-accordion-item', title: filter.label, content: filter_content, show_icon: true, is_open: true %}
      {%- endfor -%}
    </ra-accordion>
  </form>
</ra-search-filters>
