{
  "id": {{ product.id }},
  "available": {{ product.available | json }},
  "title": {{ product.title | json }},
  "handle": {{ product.handle | json }},
  "type": {{ product.type | json }},
  "vendor": {{ product.vendor | json }},
  "url": {{ product.url | json }},
  "price": {{ product.price | json }},
  "price_min": {{ product.price_min | json }},
  "price_max": {{ product.price_max | json }},
  "price_varies": {{ product.price_varies | json }},
  "compare_at_price": {{ product.compare_at_price | json }},
  "description": {{ product.description | json }},
  "excerpt": {{ product.description | strip_html | truncate: 200 | json }},
  "published_at": {{ product.published_at | date: "%b %d, %Y" | json }},
  "tags": [
    {%- for tag in product.tags -%}
      {{ tag | json}}{%- unless forloop.last -%},{%- endunless -%}
    {%- endfor -%}
  ],
  "collections": [
    {% for collection in product.collections %}
      {
        "title": {{ collection.title | json }},
        "url": {{ collection.handle | json }}
      }{%- unless forloop.last -%},{%- endunless -%}
    {% endfor %}
  ],
  "options": [
    {%- for option in product.options -%}
      {{ option | json }} {%- unless forloop.last -%},{%- endunless -%}
    {%- endfor -%}
  ],
  "options_with_values": {
    {%- for option in product.options_with_values -%}
      {{ option.name | json }}: [
        {%- for value in option.values -%}
          {{ value | json }}
          {%- unless forloop.last %},{% endunless -%}
        {%- endfor -%}
      ]
      {%- unless forloop.last %},{% endunless -%}
    {%- endfor -%}
  },
  "featured_image": {{ product.featured_image | json }},
  "images": {
    {%- if product.images -%}
      "default": [
        {%- for image in product.images -%}
          {
            "id": {{ image.id }},
            "alt": {{ image.alt | replace: '"', '\"' | json }},
            "sizes": {
              "xs": {{ image.src | img_url: '150x' | json }},
              "sm": {{ image.src | img_url: '640x' | json }},
              "md": {{ image.src | img_url: '860x' | json }},
              "lg": {{ image.src | img_url: '1200x' | json }},
              "xl": {{ image.src | img_url: '1600x' | json }},
              "original": {{ image.src | img_url: 'master' | json }}
            }
          }{%- unless forloop.last -%},{%- endunless -%}
        {%- endfor -%}
      ],
    {%- endif -%}
  },
  "variants_count": {{ product.variants.size | json }},
  "variants": [
    {%- for variant in product.variants -%}
      {
        "available": {{ variant.available | json }},
        "id": {{ variant.id }},
        "title": {{ variant.title | json }},
        "sku": {{ variant.sku | json }},
        "url": {{ variant.url | json }},
        "barcode": {{ variant.barcode | json }},
        "price": {{ variant.price | json }},
        "compare_at_price": {{ variant.compare_at_price | json }},
        "weight": {{ variant.weight | json }},
        "weight_unit": {{ variant.weight_unit | json }},
        "weight_in_unit": {{ variant.weight_in_unit | json }},
        "requires_shipping": {{ variant.requires_shipping | json }},
        "selected": {{ variant.selected | json }},
        "taxable": {{ variant.taxable | json }},
        "incoming": {{ variant.incoming | json }},
        "next_incoming_date": {{ variant.next_incoming_date | date: "%b %d, %Y" | json }},
        "inventory_policy": {{ variant.inventory_policy | json }},
        "inventory_management": {{ variant.inventory_management | json }},
        "inventory_quantity": {{ variant.inventory_quantity }},
        "images": {
          {%- if variant.image.id -%}
            "default": {
              "id": {%- if variant.image.id -%}{{ variant.image.id }}{%- else -%}""{%- endif -%},
              "alt": {{ variant.image.alt | json }},
              "sizes": {
                "sm": {{ variant.image.src | img_url: '640x' | json }},
                "md": {{ variant.image.src | img_url: '860x' | json }},
                "lg": {{ variant.image.src | img_url: '1200x' | json }},
                "xl": {{ variant.image.src | img_url: '1600x' | json }},
                "original": {{ variant.image.src | img_url: 'master' | json }}
              }
            }
          {%- endif -%}
        },
        "options": [{{ variant.option1 | json }}, {{ variant.option2 | json }}, {{ variant.option3 | json }}],
        "option1": {{ variant.option1 | json }},
        "option2": {{ variant.option2 | json }},
        "option3": {{ variant.option3 | json }},
        "requires_selling_plan": {{ variant.requires_selling_plan | json }},
        "selected_selling_plan_allocation": {{ variant.selected_selling_plan_allocation | json }},
        "selling_plan_allocations": {{ variant.selling_plan_allocations | json }}
      }{%- unless forloop.last -%},{%- endunless -%}
    {%- endfor -%}
  ],
  "selected_variant": {{ product.selected_variant | json }},
  "has_only_default_variant": {{ product.has_only_default_variant | json }},
  "first_available_variant" : {{ product.selected_or_first_available_variant | json }},
  {%- if order != blank -%}
    "order": {{ order }},
  {%- endif -%}
  "selected_selling_plan_allocation": {{ product.selected_selling_plan_allocation | json }},
  "selling_plan_groups": {{ product.selling_plan_groups | json }}
}
